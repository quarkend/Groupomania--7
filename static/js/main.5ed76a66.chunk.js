(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){},40:function(e,t,a){e.exports=a(87)},45:function(e,t,a){},47:function(e,t,a){},70:function(e,t,a){},81:function(e,t,a){},83:function(e,t,a){},85:function(e,t,a){},87:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(37),c=a.n(s),o=a(14),l=a(4),i=a(16),u=a(2),m=(a(45),a(47),a(6)),p=a(3),d=a.n(p),f=a(5),h=a(7),E=a.n(h),g=a(38),b=(a(70),a(20)),v=(a(19),a(99));function O(e){var t=e.submit,a=e.register,s=e.title,c=r.a.useState(""),o=Object(l.a)(c,2),i=o[0],u=o[1],m=r.a.useState(""),p=Object(l.a)(m,2),d=p[0],f=p[1];return Object(n.useEffect)(function(){if(i){var e=new FileReader;e.onload=function(){f(e.result)},e.readAsDataURL(i)}},[i]),r.a.createElement("form",{className:"user-action",encType:"multipart/form-data",onSubmit:t},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"user-pic"},s||"Selectioner une photo de profil",r.a.createElement(v.a,{htmlColor:"tomato",className:"shareIcon shareOption"})),r.a.createElement("input",{type:"file",id:"user-pic",style:{display:"none"},name:"image",accept:".jpeg, .png, .jpg, .gif",onChange:function(e){if(e.target.files){var t=e.target.files[0];u(t),console.log("PREVIEW",t)}},ref:a}),d&&r.a.createElement("div",{className:"profile-image-div "},r.a.createElement("img",{src:d,alt:""}))),r.a.createElement("button",{type:"submit"},"Mettre \xe0 jour"))}var N=a(101),j=a(102),S=a(100),w=function(e){var t=r.a.useContext(V),a=t.state,s=t.dispatch,c=Object(n.useState)(!1),o=Object(l.a)(c,2),i=o[0],u=o[1],m=Object(n.useRef)(null),p=function(e){m.current&&!m.current.contains(e.target)&&u(!1)};return Object(n.useEffect)(function(){return document.addEventListener("mousedown",p),function(){document.removeEventListener("mousedown",p)}}),r.a.createElement("div",{className:"dropdownwrapper",ref:m},r.a.createElement(S.a,Object.assign({onClick:function(){return u(!i)}},e)),i&&r.a.createElement("div",null,r.a.createElement("div",{className:"dropdown-wrapper"},r.a.createElement("ul",{className:"dropdown-menu"},r.a.createElement("li",null,r.a.createElement("a",{className:"dropdown-menu__item",href:"/"}," Home")),r.a.createElement("li",null," ",r.a.createElement("a",{className:"dropdown-menu__item",href:"/admin/"+a.user.id},"admin")," "),r.a.createElement("li",{className:"dropdown-menu__item"},"Hi ",a.user.username," (X) "),r.a.createElement("li",{className:"dropdown-menu__item",onClick:function(){return s({type:"X"})}},"Deconexion")))))},y="http://localhost:8800/api/users/",k="http://localhost:8800/images/";function x(e){var t=e.post,a=Object(b.a)(),s=a.handleSubmit,c=a.register,o=Object(n.useState)(""),i=Object(l.a)(o,2),p=i[0],h=i[1],v=Object(n.useState)(!1),S=Object(l.a)(v,2),x=S[0],C=S[1],I=Object(n.useState)(!1),A=Object(l.a)(I,2),T=A[0],P=A[1],B=Object(n.useState)([]),F=Object(l.a)(B,2),J=F[0],R=F[1],z=Object(n.useState)(""),L=Object(l.a)(z,2),U=L[0],_=L[1],D=Object(n.useState)([]),q=Object(l.a)(D,2),H=q[0],M=q[1],W=(Object(n.useContext)(V).user,Object(n.useState)(null)),G=Object(l.a)(W,2),X=G[0],Z=G[1],Q=Object(n.useState)(!1),K=Object(l.a)(Q,2),Y=(K[0],K[1]),$=JSON.parse(localStorage.getItem("user")),ee=Object(u.g)(),te="Bearer "+JSON.parse(localStorage.getItem("token")),ae=Object(n.useState)([]),ne=Object(l.a)(ae,2),re=ne[0],se=ne[1];Object(n.useEffect)(function(){(function(){var e=Object(f.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("/users",{headers:{Authorization:te}});case 2:t=e.sent,M(t.data),localStorage.setItem("userAount",JSON.stringify(t.data)),console.log(t.data);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},[te]);var ce=function(){E.a.post("/likes",{postId:t.id,userId:$.id,like:1},{headers:{Authorization:te}}).then(function(e){se(e.data.like),localStorage.setItem("like",JSON.stringify(e.data)),console.log(re)})};Object(n.useEffect)(function(){E.a.get("/posts/byId/".concat(t.id),{headers:{Authorization:te}}).then(function(e){localStorage.setItem("post",JSON.stringify(e.data))})},[t.id,te]),console.log(t),Object(n.useEffect)(function(){E.a.get("/posts/".concat(t.id,"/comments"),{headers:{Authorization:te}}).then(function(e){R(e.data),console.log(e.data),localStorage.setItem("comments",JSON.stringify(e.data))})},[t.id,te]);var oe;function le(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(f.a)(d.a.mark(function e(a){var n,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("image",a.image[0]),console.log(a.image[0]),e.next=5,fetch("http://localhost:8800/api/posts/upimg/"+t.id,{method:"PUT",headers:{Authorization:"Bearer "+te},body:n});case 5:return r=e.sent,e.next=8,r.json();case 8:s=e.sent,console.log(s),ue(),C(!0),r.ok&&(console.log(s),setTimeout(function(){ee.push(window.location.reload())},300));case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ue(){return me.apply(this,arguments)}function me(){return(me=Object(f.a)(d.a.mark(function e(){var t,a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(y).concat($.id),e.next=3,fetch(t,{headers:{Authorization:"Bearer "+te}});case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,h(n),Y(!0),Z(X),console.log(n);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function pe(e){P(!T)}return Object(n.useEffect)(function(){ue()},[]),t.userId===$.id?oe=r.a.createElement("div",{className:"post-button"},r.a.createElement("i",{className:"fas fa-portrait white fa-2x",onClick:function(){C(!x)}}),x&&r.a.createElement(O,{submit:s(le),register:c({required:!0})}),r.a.createElement("div",{className:"postBottom"},r.a.createElement("div",{className:"postBottomLeft"}),r.a.createElement("div",{className:"postBottomRight"},r.a.createElement("span",{className:"postCommentText"},"Supprimer le post"),r.a.createElement(N.a,{className:"shareIcon",onClick:function(){var e;e=t.id,E.a.delete("http://localhost:8800/api/posts/".concat(e),{headers:{Authorization:te}}).then(function(){window.confirm("Etes vous sur de vouloir Supprimer definitivement votre POST ?"),window.location.reload(),ee.push("/")})}})))):!0===!!$.isAdmin&&(oe=r.a.createElement("div",{className:"post-button"},r.a.createElement("i",{className:"fas fa-portrait white fa-2x",onClick:function(){C(!x)}}),x&&r.a.createElement(O,{submit:s(le),register:c({required:!0})}))),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"post"},r.a.createElement("div",{className:"postWrapper"},r.a.createElement("div",{className:"postTop"},r.a.createElement("div",{className:"postTopLeft"},r.a.createElement("span",{className:"postUsername"}),H.map(function(e){return t.userId===e.id?r.a.createElement("div",{key:e.id+t.id},r.a.createElement("img",{className:"postProfileImg",src:e.profilePicture?k+e.profilePicture:"/assets/person/noAvatar.png",alt:"center"}),e.username):null})),r.a.createElement("div",{className:"postTopRight"},r.a.createElement("span",{className:"postDate"},Object(g.a)(t.createdAt)),r.a.createElement("p",{className:"postDate"}," ","Post\xe9 le"," ",t.createdAt.split("T").join(" \xe0 ").split(".000Z").join(""))),r.a.createElement(w,null)),r.a.createElement("div",{className:"detail"},r.a.createElement("div",{className:""},r.a.createElement("h3",null,"Title:",t.title," "),r.a.createElement("img",{className:"postImg",src:t.img?k+t.img:"/assets/icon/gallery.png",alt:"center"})),oe,r.a.createElement("hr",null),r.a.createElement("h3",null,"Description:",t.desc,p.like),r.a.createElement("hr",null)),r.a.createElement("div",{className:"postBottomLeft"},r.a.createElement("img",{className:"likeIcon",src:"/assets/icon/like.png",onClick:ce,alt:""}),r.a.createElement("img",{className:"likeIcon",src:"/assets/icon/heart.png",onClick:ce,alt:""}),r.a.createElement("span",{className:"postLikeCounter"}," ",re," people like it")),T.shown?r.a.createElement("div",{className:"listOfComments"},r.a.createElement("div",{className:"card-comment"},r.a.createElement("form",null,r.a.createElement("input",{className:"",id:"comm",type:"text",name:"comment",placeholder:"Laisser un commentaire ",autoComplete:"off",value:U,onChange:function(e){_(e.target.value)}})),r.a.createElement("div",{className:"card-reaction"},r.a.createElement("button",{id:"comm",onClick:function(){E.a.post("/comments",{content:U,postId:t.id,userId:$.id},{headers:{Authorization:te}}).then(function(e){if(e.data.error)console.log(e.data.error);else{var t={content:U,username:e.data.username};R([].concat(Object(m.a)(J),[t])),_("")}})}}," ","Add Comment"))),r.a.createElement("ul",{className:"comments"},J.map(function(e,t){return r.a.createElement("li",{key:t,className:"comment"},e.content,T&&$.id===r.a.createElement("div",{className:"listOfComments"})&&r.a.createElement("div",{className:"update__container",key:e.id}),r.a.createElement(N.a,{className:"shareIcon",onClick:function(){var t;t=e.id,E.a.delete("/comments/".concat(t),{headers:{Authorization:te}}).then(function(){R(J.filter(function(e){return e.id!==t}))})}}),r.a.createElement(j.a,{title:"Modification",onClick:pe,"data-id":e.id}))}))):"")),r.a.createElement("div",{className:"topbarIcon"},r.a.createElement("div",{className:"topbarIconItem"},r.a.createElement(j.a,{onClick:function(){return P({shown:!T.shown})}}),r.a.createElement("span",{className:"topbarIconBadge"},J.length))))}a(81);var C="http://localhost:8800/images/";function I(){var e=JSON.parse(localStorage.getItem("user")),t=Object(n.useRef)(),a=Object(n.useRef)(),s=Object(n.useState)(null),c=Object(l.a)(s,2),o=c[0],i=c[1],u=function(){var e=Object(f.a)(d.a.mark(function e(n){var r,s,c,l,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r=JSON.parse(localStorage.getItem("user")),s="Bearer "+r.token,c={userId:r.id,desc:t.current.value,title:a.current.value},!o){e.next=18;break}return l=new FormData,i=Date.now()+o.name,l.append("name",i),l.append("file",o),c.img=i,console.log(c),e.prev=11,e.next=14,E.a.post("http://localhost:8800/upload",l);case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:return e.prev=18,e.next=21,E.a.post("/posts",c,{headers:{Authorization:s}});case 21:window.location.reload(),e.next=26;break;case 24:e.prev=24,e.t1=e.catch(18);case 26:case"end":return e.stop()}},e,null,[[11,16],[18,24]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"share"},r.a.createElement("div",{className:"shareWrapper"},r.a.createElement("div",{className:"shareTop"},r.a.createElement("img",{className:"shareProfileImg",src:e.profilePicture?C+e.profilePicture:"/assets/person/noAvatar.png",alt:"profilePicture"}),r.a.createElement("input",{placeholder:e.username+": Create Post : Title ?",className:"shareInput",ref:a}),r.a.createElement("input",{placeholder:"Description ?",className:"shareInput",ref:t})),r.a.createElement("hr",{className:"shareHr"}),o&&r.a.createElement("div",{className:"shareImgContainer"},r.a.createElement("img",{className:"shareImg",src:URL.createObjectURL(o),alt:""}),r.a.createElement(N.a,{className:"shareCancelImg",onClick:function(){return i(null)}})),r.a.createElement("form",{className:"shareBottom",onSubmit:u},r.a.createElement("div",{className:"shareOptions"},r.a.createElement("label",{htmlFor:"file",className:"shareOption"},r.a.createElement(v.a,{htmlColor:"tomato",className:"shareIcon"}),r.a.createElement("span",{className:"shareOptionText"},"Multimedia"),r.a.createElement("input",{style:{display:"none"},type:"file",id:"file",accept:".png,.jpeg,.jpg",onChange:function(e){return i(e.target.files[0])}}))),r.a.createElement("button",{className:"shareButton",type:"submit"},"Share"))))}var A={posts:[],isFetching:!1,hasError:!1},T=function(e,t){switch(t.type){case"FETCH_POSTS_REQUEST":return Object(i.a)({},e,{isFetching:!0,hasError:!1});case"FETCH_POSTS_SUCCESS":return Object(i.a)({},e,{isFetching:!1,posts:t.payload});case"FETCH_POSTS_FAILURE":return Object(i.a)({},e,{hasError:!0,isFetching:!1});default:return e}},P=function(){var e=r.a.useContext(V).state,t=r.a.useReducer(T,A),a=Object(l.a)(t,2),n=a[0],s=a[1];return r.a.useEffect(function(){s({type:"FETCH_POSTS_REQUEST"}),fetch("/posts",{headers:{Authorization:"Bearer ".concat(e.token)}}).then(function(e){if(e.ok)return e.json();throw e}).then(function(e){s({type:"FETCH_POSTS_SUCCESS",payload:e})}).catch(function(e){console.log(e),s({type:"FETCH_POSTS_FAILURE"})})},[e.token]),r.a.createElement("div",{className:"homeContainer"},r.a.createElement("div",{className:"feed"},r.a.createElement("div",{className:"feedWrapper"},r.a.createElement(I,null)),n.isFetching?r.a.createElement("span",{className:"loader"},"LOADING..."):n.hasError?r.a.createElement("span",{className:"error"},"AN ERROR HAS OCCURED"):r.a.createElement(r.a.Fragment,null,n.posts.map(function(e){return r.a.createElement(x,{key:e.id.toString(),post:e})}))))},B=a(103);a(83);function F(e){var t=e.username,a=Object(n.useContext)(V).user,s=Object(n.useState)([]),c=Object(l.a)(s,2),o=c[0],i=c[1],u="Bearer "+JSON.parse(localStorage.getItem("user")).token;return Object(n.useEffect)(function(){(function(){var e=Object(f.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:E.a.get("/posts",{headers:{Authorization:"Bearer"+u}}).then(function(e){i(e.data),localStorage.setItem(" setLtOfPtsbyuserId",JSON.stringify(e.data))});case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},[]),r.a.createElement("div",{className:"feed"},r.a.createElement("div",{className:"feedWrapper"},(!t||t===a.username)&&r.a.createElement(I,null),o.map(function(e){return r.a.createElement(x,{key:e.id,post:e})})))}function J(e){var t=e.submit,a=e.register,n=e.content;return r.a.createElement("form",{className:"card-input",onSubmit:t},r.a.createElement("div",{className:"form-group "},r.a.createElement("label",{htmlFor:"Noveau Username"}," ",n||"Username"),r.a.createElement("input",{className:"card-edit",type:"text",name:"username",id:"username",placeholder:void 0===n?"Username...":n,ref:a})))}function R(e){var t=e.submit,a=e.register,n=e.content;return r.a.createElement("form",{className:"card-input",onSubmit:t},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"}," ",n||"Email"),r.a.createElement("input",{className:"add-input",type:"text",name:"email",id:"email",placeholder:void 0===n?"E-mail...":n,ref:a})))}function z(){var e=Object(u.h)().id,t=Object(u.g)(),a=r.a.useContext(V).state,s=JSON.parse(localStorage.getItem("user")),c=s.id,o="Bearer "+s.token,i=Object(n.useState)(""),m=Object(l.a)(i,2),p=m[0],h=m[1],E=Object(b.a)(),g=E.handleSubmit,v=E.register,N=Object(n.useState)(!1),j=Object(l.a)(N,2),S=j[0],w=j[1],y=Object(n.useState)(!1),k=Object(l.a)(y,2),x=k[0],C=k[1],I=Object(n.useState)(!1),A=Object(l.a)(I,2),T=A[0],P=A[1];function z(){return(z=Object(f.a)(d.a.mark(function e(t){var a,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("image",t.image[0]),e.next=4,fetch("http://localhost:8800/api/profile".concat("/",s.id),{method:"put",headers:{Authorization:"Bearer "+o},body:a});case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,console.log(r),window.location.reload(),w(!1);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(){return(L=Object(f.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),_(),C(!1);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U(){return(U=Object(f.a)(d.a.mark(function e(t){var a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8800/api/profile".concat("/",s.id),{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+o},body:JSON.stringify(t)});case 2:return a=e.sent,console.log(t),e.next=6,a.json();case 6:n=e.sent,_(),P(!1),console.log(n);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(){return D.apply(this,arguments)}function D(){return(D=Object(f.a)(d.a.mark(function e(){var t,a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="http://localhost:8800/api/profile/".concat(c),e.next=3,fetch(t,{headers:{Authorization:"Bearer "+o}});case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,h(n),console.log(n);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(n.useEffect)(function(){_(),console.log(p.username)},[]),r.a.createElement("div",{className:"profilePageContainer"},r.a.createElement("div",{className:"profile"},r.a.createElement("div",{className:"profileRight"},r.a.createElement("div",{className:"profileRightTop"},r.a.createElement("div",{className:"profileCover"},r.a.createElement("img",{className:"profileCoverImg",src:"/assets/groupomania.jpg ",alt:""}),r.a.createElement("img",{className:"profileUserImg",src:p.profilePicture?"http://localhost:8800/images/"+p.profilePicture:"/assets/person/noAvatar.png ",alt:""}),r.a.createElement("div",{className:"profileUserImgChange"},r.a.createElement(B.a,{onClick:function(){w(!S),C(!1),P(!1)}}))),r.a.createElement("div",null,r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"profileInfo"},r.a.createElement("h4",{className:"profileInfoName"},"Username : ",p.username),r.a.createElement("p",null,"Email : ",p.email),r.a.createElement("p",null,"Profil cr\xe9e le :"," ",a.user.createdAt.split("T").join(" \xe0 ").split(".000Z")),r.a.createElement("p",null,"Profil Modifi\xe9 le :"," ",a.user.updatedAt.split("T").join(" \xe0 ").split(".000Z"))),r.a.createElement("div",{className:"user-action"},r.a.createElement("i",{className:"fas fa-user white fa-2x",onClick:function(){P(!T),C(!1),w(!1)}}," "),r.a.createElement("i",{className:"fas fa-envelope-open white fa-2x",onClick:function(){C(!x),w(!1),P(!1)}}),r.a.createElement("i",{className:"fas fa-portrait white fa-2x",onClick:function(){w(!S),C(!1),P(!1)}}),r.a.createElement("i",{className:"fas fa-user-slash white fa-2x",onClick:function(){t.push("/deleteuser/"+e)}})),S&&r.a.createElement(O,{submit:g(function(e){return z.apply(this,arguments)}),register:v({required:!0})}),T&&r.a.createElement(J,{submit:g(function(e){return U.apply(this,arguments)}),register:v({required:!0})}),x&&r.a.createElement(R,{submit:g(function(e){return L.apply(this,arguments)}),register:v({required:!0})}))))),r.a.createElement("div",{className:"profileRightBottom"},r.a.createElement(F,null)))))}var L=a(10),U=(a(85),function(){var e=r.a.useContext(V).dispatch,t=r.a.useState({email:"",password:"",isSubmitting:!1,errorMessage:null}),a=Object(l.a)(t,2),n=a[0],s=a[1],c=function(e){s(Object(i.a)({},n,Object(L.a)({},e.target.name,e.target.value)))};return r.a.createElement("div",{className:"login-container"},r.a.createElement("div",{className:"cardlogin"},r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),s(Object(i.a)({},n,{isSubmitting:!0,errorMessage:null})),fetch("".concat("http://localhost:8800/api","/auth/login"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.email,password:n.password})}).then(function(e){var t=e.headers.get("content-type");if(!t||!t.includes("application/json"))throw new TypeError("Oops, we haven't got JSON!");return e.json()}).then(function(t){e({type:"LOGIN",payload:t})}).catch(function(e){s(Object(i.a)({},n,{isSubmitting:!1,errorMessage:e.message||e.statusText}))})}},r.a.createElement("h1",null,"Login"),r.a.createElement("label",{htmlFor:"email"},"Email Address",r.a.createElement("input",{type:"email",value:n.email,onChange:c,name:"email",id:"email"})),r.a.createElement("label",{htmlFor:"password"},"Password",r.a.createElement("input",{type:"password",value:n.password,onChange:c,name:"password",id:"password"})),n.errorMessage&&r.a.createElement("span",{className:"form-error"},n.errorMessage),r.a.createElement("button",{disabled:n.isSubmitting},n.isSubmitting?"Loading...":"Login")))))});function _(){var e=Object(n.useRef)(),t=Object(n.useRef)(),a=Object(n.useRef)(),s=Object(n.useRef)(),c=Object(u.g)(),o=function(){var n=Object(f.a)(d.a.mark(function n(r){var o;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r.preventDefault(),s.current.value===a.current.value){n.next=5;break}s.current.setCustomValidity("Passwords don't match!"),n.next=16;break;case 5:return o={username:e.current.value,email:t.current.value,password:a.current.value},n.prev=6,n.next=9,E.a.post("http://localhost:8800/api/auth/signup",o);case 9:c.push("http://localhost:8800/api/login"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(6),console.log(n.t0),window.location.reload();case 16:case"end":return n.stop()}},n,null,[[6,12]])}));return function(e){return n.apply(this,arguments)}}();return r.a.createElement("div",{className:"login-container"},r.a.createElement("div",{className:"cardlogin"},r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:o},r.a.createElement("h1",null,"Register"),r.a.createElement("label",{htmlFor:"Username"},"Username",r.a.createElement("input",{type:"username",minLength:"3",placeholder:"Username",autoComplete:"off",required:!0,ref:e,className:"loginInput"})),r.a.createElement("label",{htmlFor:"email"},"Email Address",r.a.createElement("input",{placeholder:"Email",required:!0,ref:t,className:"loginInput",type:"email",autoComplete:"off"})),r.a.createElement("label",{htmlFor:"password"},"Password",r.a.createElement("input",{placeholder:"Password",required:!0,ref:a,className:"loginInput",type:"password",minLength:"6"})),r.a.createElement("label",{htmlFor:"Password Again"},"Password Again",r.a.createElement("input",{placeholder:"Password Again",required:!0,ref:s,className:"loginInput",type:"password"})),r.a.createElement("button",{className:"loginRegisterButton",type:"submit"},"Sign Up"),r.a.createElement("button",{className:"btn btn-outline-danger btn-sm",onClick:function(){c.push("/login")}},"Login")))))}var D="/posts/",q="http://localhost:8800/images/";function H(e){var t,a=e.user,s=Object(n.useState)(null),c=Object(l.a)(s,2),o=c[0],i=c[1],m=Object(n.useState)(!1),p=Object(l.a)(m,2),h=p[0],E=p[1],g=Object(n.useState)(""),v=Object(l.a)(g,2),N=(v[0],v[1]),j=Object(b.a)(),S=j.handleSubmit,w=j.register,y=Object(n.useState)(!1),k=Object(l.a)(y,2),x=k[0],C=k[1],I=Object(n.useState)(!1),A=Object(l.a)(I,2),T=A[0],P=A[1],B=Object(n.useState)(!1),F=Object(l.a)(B,2),z=F[0],L=F[1],U=r.a.useContext(V).state,_=Object(u.g)(),H=Object(u.h)().id,M=JSON.parse(localStorage.getItem("user")),W="Bearer "+JSON.parse(localStorage.getItem("token")),G=U.user.id;function X(){return(X=Object(f.a)(d.a.mark(function e(t){var a,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("image",t.image[0]),e.next=4,fetch("/users".concat("/",M.id),{method:"put",headers:{Authorization:"Bearer "+W},body:a});case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,console.log(r),$(),C(!1);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Z(){return(Z=Object(f.a)(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8800/api/users/"+a.id,{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+W},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,console.log(r),K(),L(!1);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Q(){return(Q=Object(f.a)(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8800/api/users/"+a.id,{method:"put",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+W},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,console.log(r),K(),P(!1);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function K(){return Y.apply(this,arguments)}function Y(){return(Y=Object(f.a)(d.a.mark(function e(){var t,a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="/users/".concat("/",G),e.next=3,fetch(t,{headers:{Authorization:"Bearer "+W}});case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,N(n),console.log(n),E(!0),i(o);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $(){return ee.apply(this,arguments)}function ee(){return(ee=Object(f.a)(d.a.mark(function e(){var t,a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(D),e.next=3,fetch(t,{headers:{Authorization:"Bearer "+W}});case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,N(n),console.log(n),E(!0),i(o);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(n.useEffect)(function(){K()},[]),Object(n.useEffect)(function(){$()},[]),Object(n.useEffect)(function(){K()},[]),o?r.a.createElement("div",null,"Erreur : ",o.message):h?(U.user.id!==H&&!0!==U.user.isAdmin||(t=r.a.createElement("div",{className:"user-button"},r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"user-action"},r.a.createElement("i",{className:"fas fa-user white fa-3x",onClick:function(){L(!z),P(!1),C(!1)}},"  "),r.a.createElement("i",{className:"fas fa-envelope-open white fa-3x",onClick:function(){P(!T),C(!1),L(!1)}}),r.a.createElement("i",{className:"fas fa-portrait white fa-3x",onClick:function(){C(!x),P(!1),L(!1)}}),r.a.createElement("i",{className:"fas fa-user-slash white fa-3x",onClick:function(){_.push("/deleteuser/"+H)}}))),x&&r.a.createElement(O,{submit:S(function(e){return X.apply(this,arguments)}),register:w({required:!0})}),z&&r.a.createElement(J,{submit:S(function(e){return Z.apply(this,arguments)}),register:w({required:!0})}),T&&r.a.createElement(R,{submit:S(function(e){return Q.apply(this,arguments)}),register:w({required:!0})})))),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"detail"},r.a.createElement("div",{className:"postTopRight"},r.a.createElement("h4",{className:"postDate"},"Compte Cr\xe9e le : ",a.createdAt.split("T").join(" \xe0 ").split(".000Z").join(""))),r.a.createElement("h3",null," Username:",a.username," "),r.a.createElement("h3",null," Email:",a.email," "),r.a.createElement("img",{className:"postProfileImg",src:a.profilePicture?q+a.profilePicture:"/assets/person/noAvatar.png",alt:"user"}),r.a.createElement("div",{className:"postsAdmin"},r.a.createElement("div",null,t))))):r.a.createElement("div",null,"Chargement...")}var M="/posts/";function W(){var e=Object(u.h)().id,t=Object(n.useState)([]),a=Object(l.a)(t,2),s=a[0],c=a[1],o=Object(n.useState)([]),i=Object(l.a)(o,2),m=(i[0],i[1]),p=JSON.parse(localStorage.getItem("user")),h="Bearer "+JSON.parse(localStorage.getItem("token")),g=p.id,b=Object(n.useState)(""),v=Object(l.a)(b,2),O=(v[0],v[1]);function N(){return(N=Object(f.a)(d.a.mark(function e(){var t,a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="/users/".concat("/",g),e.next=3,fetch(t,{headers:{Authorization:"Bearer "+h}});case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,O(n),console.log(n);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(){return(j=Object(f.a)(d.a.mark(function e(){var t,a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(M),e.next=3,fetch(t,{headers:{Authorization:"Bearer "+h}});case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,O(n),console.log(n);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(n.useEffect)(function(){!function(){N.apply(this,arguments)}()},[]),Object(n.useEffect)(function(){!function(){j.apply(this,arguments)}()},[]),Object(n.useEffect)(function(){E.a.get("/users/".concat(e),{headers:{Authorization:h}}).then(function(e){m(e.data),console.log(e.data),localStorage.setItem(" setLisuserIdX",JSON.stringify(e.data))})},[e,h]),Object(n.useEffect)(function(){(function(){var e=Object(f.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("/users",{headers:{Authorization:h}});case 2:t=e.sent,c(t.data),localStorage.setItem("userAount",JSON.stringify(t.data)),console.log(t.data);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},[h]),r.a.createElement("div",{className:"profilePageContainer"},r.a.createElement("div",{className:"profile"},r.a.createElement("div",{className:"card"},r.a.createElement("h4",{className:"profile-title"},"Admin"))),s.map(function(e){return r.a.createElement(H,{key:e.id,user:e})}))}function G(){var e=Object(u.g)(),t=r.a.useContext(V),a=JSON.parse(localStorage.getItem("user")),s=a.id,c="Bearer "+a.token,l=Object(n.useCallback)(function(t){window.confirm("Etes vous sur de vouloir Supprimer definitivement votre compte ?")&&fetch("/users/"+s,{method:"delete",headers:{"Content-type":"application/json",Authorization:c},body:JSON.stringify({id:t.id,userId:s})}).then(function(e){return e.json()}).then(function(t){t.error?alert("Votre compte n'a pas pu \xeatre supprim\xe9."):(alert("Compte supprim\xe9 !"),e.push("/"),window.location.reload(),localStorage.clear())}).catch(function(e){alert("Votre compte n'a pas pu \xeatre supprim\xe9 !"),console.error("There was an error!",e)})},[t,s,c]);return r.a.createElement("div",{className:"card"},r.a.createElement("h1",null,"Souhaitez vous vraiment supprimer votre compte ?"),r.a.createElement("div",{className:"form-submit"},r.a.createElement(o.b,{to:"/",className:"btn btn-outline-info btn-sm"},"Home"),r.a.createElement("button",{className:"btn btn-outline-danger btn-sm",onClick:l},"Supprimer mon compte")))}var V=r.a.createContext(),X={isAuthenticated:!1,isAdmin:!1,user:JSON.parse(localStorage.getItem("user"))||null,token:null},Z=function(e,t){switch(t.type){case"LOGIN":return localStorage.setItem("user",JSON.stringify(t.payload.user)),localStorage.setItem("token",JSON.stringify(t.payload.token)),Object(i.a)({},e,{isAdmin:!0,isAuthenticated:!0,user:t.payload.user,token:t.payload.token});case"X":return localStorage.clear(),Object(i.a)({},e,{isAuthenticated:!1,user:null});default:return e}};var Q=function(){var e=r.a.useReducer(Z,X),t=Object(l.a)(e,2),a=t[0],n=t[1];return r.a.useEffect(function(){var e=JSON.parse(localStorage.getItem("user")||null),t=JSON.parse(localStorage.getItem("token")||null);e&&t&&n({type:"LOGIN",payload:{user:e,token:t}})},[]),r.a.createElement(o.a,{basename:"/"},r.a.createElement(V.Provider,{value:{state:a,dispatch:n}},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/"},a.isAuthenticated?r.a.createElement(P,null):r.a.createElement(_,null)),r.a.createElement(u.b,{path:"/login"},a.isAuthenticated?r.a.createElement(u.a,{to:"/"}):r.a.createElement(U,null)),r.a.createElement(u.b,{path:"/register"},a.isAuthenticated?r.a.createElement(u.a,{to:"/"}):r.a.createElement(_,null)),r.a.createElement(u.b,{path:"/profile/:username"},r.a.createElement(z,null)),r.a.createElement(u.b,{path:"/admin/:id"},a.isAuthenticated?r.a.createElement(W,null):r.a.createElement(u.a,{to:"/"})),r.a.createElement(u.b,{path:"/deleteuser/:id"},r.a.createElement(G,null)),r.a.createElement(u.b,{path:"/updateprofilephoto"},r.a.createElement(O,null)))))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,null,r.a.createElement(Q,null))),document.getElementById("root"))}},[[40,2,1]]]);